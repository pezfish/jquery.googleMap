/**
* jQuery Google Map Helper
* Copyright (c) 2012 Kevin Doyle & Jonathan Hopkins
* Dual licensed under the MIT and GPL licenses:
* http://www.opensource.org/licenses/mit-license.php
* http://www.gnu.org/licenses/gpl.html
**/

(function(b){b.fn.googleMap=function(e){e=b.extend({mapType:"roadmap"},e);return this.each(function(){var l=b(this)[0],c,d,g,k,f,h;switch(e.mapType){case "roadmap":c=google.maps.MapTypeId.ROADMAP;break;case "satellite":c=google.maps.MapTypeId.SATELLITE;break;case "hybrid":c=google.maps.MapTypeId.HYBRID;break;case "terrain":c=google.maps.MapTypeId.TERRAIN}c={zoom:8,center:new google.maps.LatLng(0,0),mapTypeId:c};d=new google.maps.Map(l,c);h=new google.maps.InfoWindow;b.ajax({type:"GET",dataType:"json",
url:"data.json",success:function(a){for(i=0;i<a.sets.length;i++){var c=a.sets[i];g=new google.maps.LatLngBounds;for(j=0;j<c.points.length;j++){var e=c.points[j];k=new google.maps.LatLng(e.latlng[0],e.latlng[1]);f=new google.maps.Marker({map:d,position:k,icon:null});google.maps.event.addListener(f,"click",function(a,b){return function(){h.setContent(c.points[b].content);h.open(d,a)}}(f,j));g.extend(f.getPosition())}c.bounds=g}if(null!==a.initialset)for(i=0;i<a.sets.length;i++)a.sets[i].setid===a.initialset&&
(d.fitBounds(a.sets[i].bounds),setTimeout(function(){d.setZoom(Math.min(d.getZoom(),15))},50),b(".set").removeClass("active"),b("#"+a.initialset).addClass("active"));else d.fitBounds(a.sets[0].bounds),setTimeout(function(){d.setZoom(Math.min(d.getZoom(),15))},50),b(".set").removeClass("active"),b("#"+a.sets[0].setid).addClass("active");b(".set").click(function(){curid=b(this).attr("id");for(i=0;i<a.sets.length;i++)a.sets[i].setid===curid&&(d.fitBounds(a.sets[i].bounds),d.setZoom(Math.min(d.getZoom(),
15)),b(".set").removeClass("active"),b(this).addClass("active"));return!1})}})})}})(jQuery);